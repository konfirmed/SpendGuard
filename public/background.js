(()=>{"use strict";const e="purchases",t="totalIntercepts";async function a(e){return(await chrome.storage.local.get(e))[e]}async function n(e,t){await chrome.storage.local.set({[e]:t})}chrome.runtime.onInstalled.addListener((async()=>{console.log("SpendGuard installed â€“ initializing storage"),await n(e,[]),await n(t,0),await n("settings",{cooldownSeconds:30,enableNudges:!0,enableScamDetection:!0})})),chrome.runtime.onMessage.addListener(((s,c,o)=>((async()=>{if("incrementIntercepts"===s.action){const e=(await a(t)||0)+1;await n(t,e),o({success:!0,newCount:e})}if("addPurchase"===s.action){const t=await a(e)||[];t.unshift({...s.purchase,id:Date.now().toString()}),t.length>100&&t.splice(100),await n(e,t),o({success:!0})}if("getSettings"===s.action){const e=await a("settings")||{cooldownSeconds:30,enableNudges:!0,enableScamDetection:!0};o({success:!0,settings:e})}})().catch((e=>{console.error("SpendGuard background error:",e),o({success:!1,error:e.message})})),!0)))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFja2dyb3VuZC5qcyIsIm1hcHBpbmdzIjoibUJBRUEsTUFBTUEsRUFBd0IsWUFDeEJDLEVBQXlCLGtCQUkvQkMsZUFBZUMsRUFBV0MsR0FFdEIsYUFEcUJDLE9BQU9DLFFBQVFDLE1BQU1DLElBQUlKLElBQ2hDQSxFQUNsQixDQUlBRixlQUFlTyxFQUFXTCxFQUFLTSxTQUNyQkwsT0FBT0MsUUFBUUMsTUFBTUksSUFBSSxDQUFFLENBQUNQLEdBQU1NLEdBQzVDLENBRUFMLE9BQU9PLFFBQVFDLFlBQVlDLGFBQVlaLFVBQ25DYSxRQUFRQyxJQUFJLHFEQUNOUCxFQUFXVCxFQUF1QixVQUNsQ1MsRUFBV1IsRUFBd0IsU0FDbkNRLEVBQVcsV0FBWSxDQUN6QlEsZ0JBQWlCLEdBQ2pCQyxjQUFjLEVBQ2RDLHFCQUFxQixPQUk3QmQsT0FBT08sUUFBUVEsVUFBVU4sYUFBWSxDQUFDTyxFQUFTQyxFQUFRQyxLQUNuRCxXQUNJLEdBQXVCLHdCQUFuQkYsRUFBUUcsT0FBa0MsQ0FDMUMsTUFDTUMsU0FEaUJ0QixFQUFXRixJQUE0QixHQUNwQyxRQUNwQlEsRUFBV1IsRUFBd0J3QixHQUN6Q0YsRUFBYSxDQUFFRyxTQUFTLEVBQU1DLFNBQVVGLEdBQzVDLENBQ0EsR0FBdUIsZ0JBQW5CSixFQUFRRyxPQUEwQixDQUNsQyxNQUFNSSxRQUFjekIsRUFBV0gsSUFBMkIsR0FDMUQ0QixFQUFLQyxRQUFRLElBQUtSLEVBQVFTLFNBQVVDLEdBQUlDLEtBQUtDLE1BQU1DLGFBQy9DTixFQUFLTyxPQUFTLEtBQ2RQLEVBQUtRLE9BQU8sV0FDVjNCLEVBQVdULEVBQXVCNEIsR0FDeENMLEVBQWEsQ0FBRUcsU0FBUyxHQUM1QixDQUNBLEdBQXVCLGdCQUFuQkwsRUFBUUcsT0FBMEIsQ0FDbEMsTUFBTWEsUUFBa0JsQyxFQUFXLGFBQWdCLENBQy9DYyxnQkFBaUIsR0FDakJDLGNBQWMsRUFDZEMscUJBQXFCLEdBRXpCSSxFQUFhLENBQUVHLFNBQVMsRUFBTVcsWUFDbEMsQ0FDSCxFQXZCRCxHQXVCS0MsT0FBTUMsSUFDUHhCLFFBQVF5QixNQUFNLCtCQUFnQ0QsR0FDOUNoQixFQUFhLENBQUVHLFNBQVMsRUFBT2MsTUFBT0QsRUFBSWxCLGNBR3ZDLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zcGVuZGd1YXJkLy4vc3JjL2JhY2tncm91bmQvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG4vLyBzcmMvYmFja2dyb3VuZC9pbmRleC50c1xuY29uc3QgU1RPUkFHRV9LRVlfUFVSQ0hBU0VTID0gJ3B1cmNoYXNlcyc7XG5jb25zdCBTVE9SQUdFX0tFWV9JTlRFUkNFUFRTID0gJ3RvdGFsSW50ZXJjZXB0cyc7XG4vKipcbiAqIEFzeW5jIHdyYXBwZXIgYXJvdW5kIGNocm9tZS5zdG9yYWdlLmxvY2FsLmdldFxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRTdG9yYWdlKGtleSkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNocm9tZS5zdG9yYWdlLmxvY2FsLmdldChrZXkpO1xuICAgIHJldHVybiByZXN1bHRba2V5XTtcbn1cbi8qKlxuICogQXN5bmMgd3JhcHBlciBhcm91bmQgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0XG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHNldFN0b3JhZ2Uoa2V5LCB2YWx1ZSkge1xuICAgIGF3YWl0IGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7IFtrZXldOiB2YWx1ZSB9KTtcbn1cbi8vIE9uIGluc3RhbGwsIGluaXRpYWxpemUgb3VyIHN0b3JhZ2Uga2V5c1xuY2hyb21lLnJ1bnRpbWUub25JbnN0YWxsZWQuYWRkTGlzdGVuZXIoYXN5bmMgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKCdTcGVuZEd1YXJkIGluc3RhbGxlZCDigJMgaW5pdGlhbGl6aW5nIHN0b3JhZ2UnKTtcbiAgICBhd2FpdCBzZXRTdG9yYWdlKFNUT1JBR0VfS0VZX1BVUkNIQVNFUywgW10pO1xuICAgIGF3YWl0IHNldFN0b3JhZ2UoU1RPUkFHRV9LRVlfSU5URVJDRVBUUywgMCk7XG4gICAgYXdhaXQgc2V0U3RvcmFnZSgnc2V0dGluZ3MnLCB7XG4gICAgICAgIGNvb2xkb3duU2Vjb25kczogMzAsXG4gICAgICAgIGVuYWJsZU51ZGdlczogdHJ1ZSxcbiAgICAgICAgZW5hYmxlU2NhbURldGVjdGlvbjogdHJ1ZSxcbiAgICB9KTtcbn0pO1xuLy8gSGFuZGxlIG1lc3NhZ2VzIGZyb20gY29udGVudCBzY3JpcHRzXG5jaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoKG1lc3NhZ2UsIHNlbmRlciwgc2VuZFJlc3BvbnNlKSA9PiB7XG4gICAgKGFzeW5jICgpID0+IHtcbiAgICAgICAgaWYgKG1lc3NhZ2UuYWN0aW9uID09PSAnaW5jcmVtZW50SW50ZXJjZXB0cycpIHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSAoYXdhaXQgZ2V0U3RvcmFnZShTVE9SQUdFX0tFWV9JTlRFUkNFUFRTKSkgfHwgMDtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBjdXJyZW50ICsgMTtcbiAgICAgICAgICAgIGF3YWl0IHNldFN0b3JhZ2UoU1RPUkFHRV9LRVlfSU5URVJDRVBUUywgdXBkYXRlZCk7XG4gICAgICAgICAgICBzZW5kUmVzcG9uc2UoeyBzdWNjZXNzOiB0cnVlLCBuZXdDb3VudDogdXBkYXRlZCB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobWVzc2FnZS5hY3Rpb24gPT09ICdhZGRQdXJjaGFzZScpIHtcbiAgICAgICAgICAgIGNvbnN0IGxpc3QgPSAoYXdhaXQgZ2V0U3RvcmFnZShTVE9SQUdFX0tFWV9QVVJDSEFTRVMpKSB8fCBbXTtcbiAgICAgICAgICAgIGxpc3QudW5zaGlmdCh7IC4uLm1lc3NhZ2UucHVyY2hhc2UsIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCkgfSk7XG4gICAgICAgICAgICBpZiAobGlzdC5sZW5ndGggPiAxMDApXG4gICAgICAgICAgICAgICAgbGlzdC5zcGxpY2UoMTAwKTtcbiAgICAgICAgICAgIGF3YWl0IHNldFN0b3JhZ2UoU1RPUkFHRV9LRVlfUFVSQ0hBU0VTLCBsaXN0KTtcbiAgICAgICAgICAgIHNlbmRSZXNwb25zZSh7IHN1Y2Nlc3M6IHRydWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1lc3NhZ2UuYWN0aW9uID09PSAnZ2V0U2V0dGluZ3MnKSB7XG4gICAgICAgICAgICBjb25zdCBzZXR0aW5ncyA9IChhd2FpdCBnZXRTdG9yYWdlKCdzZXR0aW5ncycpKSB8fCB7XG4gICAgICAgICAgICAgICAgY29vbGRvd25TZWNvbmRzOiAzMCxcbiAgICAgICAgICAgICAgICBlbmFibGVOdWRnZXM6IHRydWUsXG4gICAgICAgICAgICAgICAgZW5hYmxlU2NhbURldGVjdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBzZW5kUmVzcG9uc2UoeyBzdWNjZXNzOiB0cnVlLCBzZXR0aW5ncyB9KTtcbiAgICAgICAgfVxuICAgIH0pKCkuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcignU3BlbmRHdWFyZCBiYWNrZ3JvdW5kIGVycm9yOicsIGVycik7XG4gICAgICAgIHNlbmRSZXNwb25zZSh7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyLm1lc3NhZ2UgfSk7XG4gICAgfSk7XG4gICAgLy8gUmV0dXJuIHRydWUgdG8ga2VlcCB0aGUgbWVzc2FnZSBjaGFubmVsIG9wZW4gZm9yIGFzeW5jIHJlc3BvbnNlXG4gICAgcmV0dXJuIHRydWU7XG59KTtcbiJdLCJuYW1lcyI6WyJTVE9SQUdFX0tFWV9QVVJDSEFTRVMiLCJTVE9SQUdFX0tFWV9JTlRFUkNFUFRTIiwiYXN5bmMiLCJnZXRTdG9yYWdlIiwia2V5IiwiY2hyb21lIiwic3RvcmFnZSIsImxvY2FsIiwiZ2V0Iiwic2V0U3RvcmFnZSIsInZhbHVlIiwic2V0IiwicnVudGltZSIsIm9uSW5zdGFsbGVkIiwiYWRkTGlzdGVuZXIiLCJjb25zb2xlIiwibG9nIiwiY29vbGRvd25TZWNvbmRzIiwiZW5hYmxlTnVkZ2VzIiwiZW5hYmxlU2NhbURldGVjdGlvbiIsIm9uTWVzc2FnZSIsIm1lc3NhZ2UiLCJzZW5kZXIiLCJzZW5kUmVzcG9uc2UiLCJhY3Rpb24iLCJ1cGRhdGVkIiwic3VjY2VzcyIsIm5ld0NvdW50IiwibGlzdCIsInVuc2hpZnQiLCJwdXJjaGFzZSIsImlkIiwiRGF0ZSIsIm5vdyIsInRvU3RyaW5nIiwibGVuZ3RoIiwic3BsaWNlIiwic2V0dGluZ3MiLCJjYXRjaCIsImVyciIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==